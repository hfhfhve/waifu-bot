<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Your Waifu 2.4</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- –ò–∫–æ–Ω–∫–∏ FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- –®—Ä–∏—Ñ—Ç Inter & Orbitron -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Orbitron:wght@600;800&display=swap" rel="stylesheet">

    <style>
        .admin-input {
            background: #111; border: 1px solid #333; color: white;
            padding: 10px; border-radius: 10px; width: 100%; margin-bottom: 10px;
        }
        .admin-btn {
            background: #2563eb; color: white; padding: 10px;
            border-radius: 10px; width: 100%; font-weight: bold;
        }
        /* === –ü–†–û–î–í–ò–ù–£–¢–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –î–ò–ó–ê–ô–ù–ê === */
        :root {
            --bg-dark: #050505;
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-highlight: rgba(255, 255, 255, 0.15);
            
            --primary-gradient: linear-gradient(135deg, #ff0080 0%, #7928ca 100%);
            --accent-pink: #ff3b9a;
            --text-main: #ffffff;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
            padding-bottom: 110px;
            position: relative;
        }

        /* –ñ–∏–≤–æ–π —Ñ–æ–Ω (Floating Orbs) */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            animation: floatOrb 10s infinite ease-in-out;
            opacity: 0.4;
        }
        .orb-1 {
            top: -10%; left: -10%; width: 300px; height: 300px;
            background: #7928ca;
            animation-delay: 0s;
        }
        .orb-2 {
            bottom: 20%; right: -10%; width: 250px; height: 250px;
            background: #ff0080;
            animation-delay: -5s;
        }
        
        @keyframes floatOrb {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(20px, 40px); }
        }

        /* –°–∫—Ä—ã—Ç–∏–µ —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
        ::-webkit-scrollbar { display: none; }

        /* === –≠–§–§–ï–ö–¢–´ –°–¢–ï–ö–õ–ê === */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .glass-nav {
            background: rgba(10, 10, 10, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid var(--glass-border);
            box-shadow: 0 -4px 20px rgba(0,0,0,0.5);
        }

        /* === –ö–ê–†–¢–û–ß–ö–ò === */
        .premium-card {
            background: linear-gradient(180deg, rgba(30,30,30,0.6) 0%, rgba(20,20,20,0.8) 100%);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }
        
        .premium-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, var(--glass-highlight), transparent);
            opacity: 0.5;
        }

        .premium-card:active {
            transform: scale(0.97);
            border-color: rgba(255, 255, 255, 0.2);
        }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ */
        .custom-tab-bg {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 16px;
            padding: 4px;
            border: 1px solid var(--glass-border);
        }

        .tab-active {
            background: #222;
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            border-radius: 12px;
        }
        
        .tab-inactive {
            color: #666;
            transition: color 0.3s;
        }
        .tab-inactive:hover { color: #aaa; }

        /* === –ê–ù–ò–ú–ê–¶–ò–ò === */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        .animate-fade-up {
            animation: fadeUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        .delay-100 { animation-delay: 0.05s; }
        .delay-200 { animation-delay: 0.1s; }
        
        @keyframes shine {
            0% { transform: translateX(-100%) skewX(-20deg); }
            100% { transform: translateX(200%) skewX(-20deg); }
        }
        .shine-anim::after {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: translateX(-100%);
            animation: shine 3s infinite;
        }

        /* === –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û === */
        .modal-overlay {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(12px);
            transition: opacity 0.3s ease;
        }
        .modal-content {
            background: #111;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 32px 32px 0 0;
            transform: translateY(100%);
            transition: transform 0.35s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 -10px 50px rgba(0,0,0,0.8);
            background: linear-gradient(to bottom, #1a1a1a, #000);
        }
        .modal-open .modal-content { transform: translateY(0); }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω) */
        .char-modal-content {
            height: 90vh;
            border-radius: 32px 32px 0 0;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-icon-container {
            width: 48px; height: 32px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 16px; transition: all 0.3s;
        }
        .nav-active .nav-icon-container {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }
        .nav-active i {
            text-shadow: 0 0 10px rgba(255,255,255,0.6);
        }
    </style>
</head>
<body>

    <!-- –ñ–∏–≤–æ–π —Ñ–æ–Ω -->
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <!-- ================= –í–ï–†–•–ù–Ø–Ø –®–ê–ü–ö–ê ================= -->
    <div class="fixed top-0 left-0 w-full z-50 px-4 pt-3 pb-2 transition-all duration-300" style="background: linear-gradient(to bottom, rgba(5,5,5,1) 0%, rgba(5,5,5,0.9) 85%, transparent 100%);">
        <div class="flex justify-between items-center mb-5">
            <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-tr from-pink-600 to-purple-600 p-[2px] shadow-[0_0_10px_rgba(219,39,119,0.5)]">
                    <div class="w-full h-full rounded-full bg-black flex items-center justify-center overflow-hidden">
                        <img src="https://placehold.co/100x100/333/fff?text=U" class="w-full h-full object-cover">
                    </div>
                </div>
                <div>
                    <div class="flex items-center gap-1 text-sm font-bold text-gray-200">
                        <span data-i18n="hello">–ü—Ä–∏–≤–µ—Ç</span>, <span class="text-transparent bg-clip-text bg-gradient-to-r from-pink-400 to-purple-400 font-extrabold" data-i18n="player">–ò–≥—Ä–æ–∫</span>
                    </div>
                    <!-- –£–ª—É—á—à–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å -->
                    <div class="flex items-center gap-1.5 mt-0.5">
                        <div class="flex items-center bg-green-500/10 border border-green-500/20 px-1.5 py-0.5 rounded text-[9px] text-green-400 font-bold">
                            <div class="w-1.5 h-1.5 bg-green-500 rounded-full mr-1 animate-pulse"></div>
                            <span data-i18n="online">ONLINE</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ë–∞–ª–∞–Ω—Å -->
            <div class="glass-panel rounded-2xl p-1.5 pl-3 flex items-center gap-3">
                <div class="flex flex-col items-end leading-none">
                    <span id="balance-gems" class="text-sm font-black text-cyan-300 drop-shadow-[0_0_5px_rgba(103,232,249,0.5)]">0</span>
                    <i class="fa-solid fa-gem text-[8px] text-cyan-500/80 mt-0.5"></i>
                </div>
                <div class="w-[1px] h-6 bg-white/10"></div>
                <div class="flex flex-col items-start leading-none">
                    <span id="balance-stars" class="text-sm font-black text-yellow-300 drop-shadow-[0_0_5px_rgba(253,224,71,0.5)]">0</span>
                    <i class="fa-solid fa-bolt text-[8px] text-yellow-500/80 mt-0.5"></i>
                </div>
                <button onclick="switchTab('shop')" class="w-8 h-8 rounded-xl bg-gradient-to-br from-pink-500 to-purple-600 flex items-center justify-center active:scale-90 transition-transform shadow-[0_0_10px_rgba(236,72,153,0.4)] relative overflow-hidden shine-anim">
                    <i class="fa-solid fa-plus text-white text-xs relative z-10"></i>
                </button>
            </div>
        </div>

        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å (–ì–ª–∞–≤–Ω–∞—è) -->
        <div id="gender-switch" class="custom-tab-bg flex p-1 gap-1">
            <button class="flex-1 py-2.5 rounded-xl text-xs font-bold bg-[#1f1f1f] text-white shadow-lg flex items-center justify-center gap-2 border border-white/10 relative overflow-hidden group">
                <i class="fa-solid fa-venus text-pink-400 group-hover:scale-110 transition-transform"></i> 
                <span data-i18n="girls" class="tracking-wide">GIRLS</span>
                <div class="absolute bottom-0 left-0 w-full h-[2px] bg-gradient-to-r from-pink-500 to-purple-500"></div>
            </button>
            <button class="flex-1 py-2.5 rounded-xl text-xs font-medium text-gray-500 hover:text-gray-300 transition-colors flex items-center justify-center gap-2">
                <i class="fa-solid fa-mars"></i> 
                <span data-i18n="guys" class="tracking-wide">BOYS</span>
            </button>
        </div>
        
        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å (–ú–∞–≥–∞–∑–∏–Ω) -->
        <div id="shop-switch" class="hidden custom-tab-bg flex p-1 relative">
            <button onclick="switchShopSubTab('packs')" id="btn-sub-packs" class="flex-1 py-2 rounded-xl text-[11px] font-bold tab-active">
                <span data-i18n="packs">–ü–ê–ö–ï–¢–´</span>
            </button>
            <button onclick="switchShopSubTab('energy')" id="btn-sub-energy" class="flex-1 py-2 rounded-xl text-[11px] font-medium tab-inactive">
                <span data-i18n="energy">–≠–ù–ï–†–ì–ò–Ø</span>
            </button>
            <button onclick="switchShopSubTab('gems')" id="btn-sub-gems" class="flex-1 py-2 rounded-xl text-[11px] font-medium tab-inactive">
                <span data-i18n="gems">–ì–ï–ú–´</span>
            </button>
        </div>
    </div>

    <!-- –û–¢–°–¢–£–ü -->
    <div class="h-36 w-full"></div>

    <!-- ================= –ì–õ–ê–í–ù–ê–Ø ================= -->
    <div id="tab-home" class="px-3 min-h-screen">
        
        <!-- Daily Bonus -->
        <div class="mb-4 animate-fade-up">
            <div class="w-full p-4 rounded-3xl relative overflow-hidden border border-yellow-500/20 bg-gradient-to-r from-[#1a1500] to-[#2a1a00] group cursor-pointer active:scale-98 transition-transform shadow-lg">
                <div class="flex justify-between items-center relative z-10">
                    <div>
                        <div class="flex items-center gap-2 mb-1">
                            <span class="text-[10px] font-black uppercase text-yellow-500 tracking-wider bg-yellow-500/10 px-2 py-0.5 rounded" data-i18n="bonus">Bonus</span>
                            <div class="flex gap-0.5">
                                <div class="w-1.5 h-1.5 rounded-full bg-yellow-500"></div>
                                <div class="w-1.5 h-1.5 rounded-full bg-yellow-500"></div>
                                <div class="w-1.5 h-1.5 rounded-full bg-yellow-500/30"></div>
                            </div>
                        </div>
                        <h3 class="text-lg font-bold text-white" id="daily-title" data-i18n="day_3">–î–µ–Ω—å 3</h3>
                        <p class="text-xs text-gray-400" id="daily-text">–ó–∞—Ö–æ–¥–∏ –∑–∞–≤—Ç—Ä–∞ –∑–∞ <span class="text-yellow-400 font-bold">500 –º–æ–Ω–µ—Ç</span></p>
                    </div>
                    <div class="w-12 h-12 rounded-full bg-gradient-to-b from-yellow-300 to-orange-500 flex items-center justify-center shadow-[0_0_20px_rgba(255,165,0,0.4)] animate-pulse">
                        <i class="fa-solid fa-gift text-white text-xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Grid -->
        <div class="grid grid-cols-2 gap-3 pb-6" id="characters-container">
            <!-- JS -->
        </div>
        <div class="h-10"></div>
    </div>

    <!-- ================= –ú–ê–ì–ê–ó–ò–ù ================= -->
    <div id="tab-shop" class="hidden px-4 min-h-screen">
        
        <!-- 1. –ü–ê–ö–ï–¢–´ -->
        <div id="shop-section-packs" class="space-y-5 animate-fade-up">
            <!-- Starter Pack -->
            <div class="premium-card p-5 group cursor-pointer" onclick="openPaymentModal('pack_starter', 'Starter Pack', 350, 499)">
                <div class="absolute -right-8 -top-8 w-24 h-24 bg-blue-500/20 rounded-full blur-2xl group-hover:bg-blue-500/30 transition-colors"></div>
                <div class="flex justify-between items-start mb-4 relative z-10">
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 rounded-2xl bg-[#1a1a1a] border border-white/10 flex items-center justify-center text-2xl shadow-inner">üì¶</div>
                        <div>
                            <span class="block font-bold text-lg text-white">Starter</span>
                            <span class="text-[10px] text-gray-400 uppercase tracking-wider" data-i18n="pack_starter_desc">–ù–∞–±–æ—Ä –Ω–æ–≤–∏—á–∫–∞</span>
                        </div>
                    </div>
                </div>
                <div class="flex gap-2 mb-4">
                    <div class="flex-1 bg-black/40 p-2.5 rounded-xl border border-white/5 flex flex-col items-center justify-center">
                        <span class="font-black text-lg text-white">300</span>
                        <div class="text-[9px] text-yellow-400 font-bold flex items-center gap-1"><i class="fa-solid fa-bolt"></i> <span data-i18n="energy_unit">–≠–Ω–µ—Ä–≥–∏–∏</span></div>
                    </div>
                    <div class="flex-1 bg-black/40 p-2.5 rounded-xl border border-white/5 flex flex-col items-center justify-center">
                        <span class="font-black text-lg text-white">60</span>
                        <div class="text-[9px] text-cyan-400 font-bold flex items-center gap-1"><i class="fa-solid fa-gem"></i> <span data-i18n="gems_unit">–ì–µ–º–æ–≤</span></div>
                    </div>
                </div>
                <div class="flex gap-2">
                    <div class="flex-1 bg-[#1a3a4a] border border-cyan-500/30 rounded-xl py-2 flex flex-col items-center justify-center relative overflow-hidden">
                        <span class="text-xs font-bold text-cyan-300">499 ‚ÇΩ</span>
                        <div class="absolute bottom-0 w-full h-0.5 bg-cyan-500/50"></div>
                    </div>
                    <div class="flex-1 bg-[#2a2a1a] border border-yellow-500/30 rounded-xl py-2 flex flex-col items-center justify-center relative overflow-hidden">
                        <span class="text-xs font-bold text-yellow-300">350 ‚≠êÔ∏è</span>
                        <div class="absolute bottom-0 w-full h-0.5 bg-yellow-500/50"></div>
                    </div>
                </div>
            </div>

            <!-- Premium Pack -->
            <div class="premium-card p-5 group cursor-pointer border-purple-500/30" onclick="openPaymentModal('pack_premium', 'Premium Pack', 1000, 1499)">
                <div class="absolute -right-8 -top-8 w-28 h-28 bg-purple-500/20 rounded-full blur-2xl"></div>
                <div class="absolute top-0 right-0 bg-purple-600 text-[9px] font-bold text-white px-3 py-1 rounded-bl-xl z-20">POPULAR</div>
                <div class="flex justify-between items-start mb-4 relative z-10">
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 rounded-2xl bg-[#1a1a1a] border border-white/10 flex items-center justify-center text-2xl shadow-inner">üíé</div>
                        <div>
                            <span class="block font-bold text-lg text-white">Premium</span>
                            <span class="text-[10px] text-purple-300 uppercase tracking-wider" data-i18n="pack_premium_desc">–í—ã–≥–æ–¥–Ω—ã–π –≤—ã–±–æ—Ä</span>
                        </div>
                    </div>
                </div>
                <div class="flex gap-2 mb-4">
                    <div class="flex-1 bg-black/40 p-2.5 rounded-xl border border-white/5 flex flex-col items-center justify-center">
                        <span class="font-black text-lg text-white">1000</span>
                        <div class="text-[9px] text-yellow-400 font-bold flex items-center gap-1"><i class="fa-solid fa-bolt"></i> <span data-i18n="energy_unit">–≠–Ω–µ—Ä–≥–∏–∏</span></div>
                    </div>
                    <div class="flex-1 bg-black/40 p-2.5 rounded-xl border border-white/5 flex flex-col items-center justify-center">
                        <span class="font-black text-lg text-white">200</span>
                        <div class="text-[9px] text-cyan-400 font-bold flex items-center gap-1"><i class="fa-solid fa-gem"></i> <span data-i18n="gems_unit">–ì–µ–º–æ–≤</span></div>
                    </div>
                </div>
                <div class="flex gap-2">
                    <div class="flex-1 bg-[#2d1b3a] border border-purple-500/40 rounded-xl py-2 flex flex-col items-center justify-center">
                        <span class="text-xs font-bold text-purple-200">1 499 ‚ÇΩ</span>
                    </div>
                    <div class="flex-1 bg-[#2a2a1a] border border-yellow-500/30 rounded-xl py-2 flex flex-col items-center justify-center">
                        <span class="text-xs font-bold text-yellow-300">1 000 ‚≠êÔ∏è</span>
                    </div>
                </div>
            </div>

            <!-- Ultimate Pack -->
            <div class="premium-card p-0 group cursor-pointer border-pink-500/50 shadow-[0_0_25px_rgba(236,72,153,0.15)]" onclick="openPaymentModal('pack_ultimate', 'Ultimate Pack', 2500, 3999)">
                <div class="absolute inset-0 bg-gradient-to-r from-pink-900/40 to-black/80 z-0"></div>
                <img src="https://placehold.co/400x150/500/f0f?text=MAX" class="absolute inset-0 w-full h-full object-cover opacity-10 mix-blend-overlay">
                <div class="p-5 relative z-10">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-12 h-12 rounded-2xl bg-gradient-to-br from-pink-500 to-rose-600 flex items-center justify-center text-2xl shadow-lg shadow-pink-500/30">üëë</div>
                        <div>
                            <span class="block font-black text-xl italic text-transparent bg-clip-text bg-gradient-to-r from-white to-pink-200">ULTIMATE</span>
                            <span class="text-[10px] text-pink-200 font-bold tracking-wider uppercase" data-i18n="pack_ultimate_desc">–í—Å—ë –≤–∫–ª—é—á–µ–Ω–æ</span>
                        </div>
                    </div>
                    <div class="flex gap-2 mb-4">
                        <div class="bg-black/60 backdrop-blur-sm px-3 py-2 rounded-lg border border-pink-500/30 flex-1 text-center">
                            <span class="font-black text-white block">2500</span>
                            <span class="text-[9px] text-yellow-400 font-bold uppercase"><i class="fa-solid fa-bolt"></i> Energy</span>
                        </div>
                        <div class="bg-black/60 backdrop-blur-sm px-3 py-2 rounded-lg border border-pink-500/30 flex-1 text-center">
                            <span class="font-black text-white block">500</span>
                            <span class="text-[9px] text-cyan-400 font-bold uppercase"><i class="fa-solid fa-gem"></i> Gems</span>
                        </div>
                    </div>
                      <div class="flex gap-2">
                        <div class="flex-1 bg-gradient-to-r from-pink-600 to-rose-600 rounded-xl py-2.5 text-center shadow-lg">
                            <span class="text-sm font-black text-white">3 999 ‚ÇΩ</span>
                        </div>
                          <div class="flex-1 bg-[#2a2a1a] border border-yellow-500/30 rounded-xl py-2.5 text-center">
                            <span class="text-sm font-bold text-yellow-400">2 500 ‚≠êÔ∏è</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. –≠–ù–ï–†–ì–ò–Ø -->
        <div id="shop-section-energy" class="hidden space-y-3 animate-fade-up">
            <div class="text-xs font-bold text-gray-500 uppercase tracking-widest pl-1 mb-2" data-i18n="refill_energy">–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≠–Ω–µ—Ä–≥–∏–∏</div>
            
            <!-- 50 Energy -->
             <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform" onclick="openPaymentModal('energy_50', '50 –≠–Ω–µ—Ä–≥–∏–∏', 50, 69)">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-[#1f1f1f] border border-white/5 flex items-center justify-center text-yellow-400 text-lg relative">
                        <i class="fa-solid fa-bolt"></i>
                        <span class="absolute -bottom-1 -right-1 text-[9px] font-bold text-gray-500">S</span>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-i18n="energy_50">50 –≠–Ω–µ—Ä–≥–∏–∏</div>
                        <div class="text-xs text-gray-500">69 ‚ÇΩ / 50 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-gray-400"><i class="fa-solid fa-plus"></i></div>
            </div>

            <!-- 150 Energy (New) -->
            <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform" onclick="openPaymentModal('energy_150', '150 –≠–Ω–µ—Ä–≥–∏–∏', 125, 169)">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-[#1f1f1f] border border-white/5 flex items-center justify-center text-yellow-400 text-lg relative">
                        <i class="fa-solid fa-bolt"></i>
                        <span class="absolute -bottom-1 -right-1 text-[9px] font-bold text-gray-500">M</span>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-i18n="energy_150">150 –≠–Ω–µ—Ä–≥–∏–∏</div>
                        <div class="text-xs text-gray-500">169 ‚ÇΩ / 125 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-gray-400"><i class="fa-solid fa-plus"></i></div>
            </div>
            
            <!-- 500 Energy -->
             <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform border-yellow-500/30 bg-yellow-900/10" onclick="openPaymentModal('energy_500', '500 –≠–Ω–µ—Ä–≥–∏–∏', 350, 449)">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-yellow-500/20 border border-yellow-500/30 flex items-center justify-center text-yellow-400 text-xl"><i class="fa-solid fa-fire"></i></div>
                    <div>
                        <div class="font-bold text-white" data-i18n="energy_500">500 –≠–Ω–µ—Ä–≥–∏–∏</div>
                        <div class="text-xs text-yellow-500 font-bold">449 ‚ÇΩ / 350 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-yellow-500 text-black flex items-center justify-center shadow-lg shadow-yellow-500/20"><i class="fa-solid fa-plus"></i></div>
            </div>

            <!-- 1200 Energy (New) -->
            <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform" onclick="openPaymentModal('energy_1200', '1200 –≠–Ω–µ—Ä–≥–∏–∏', 750, 899)">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-[#1f1f1f] border border-white/5 flex items-center justify-center text-yellow-400 text-lg relative">
                        <i class="fa-solid fa-bolt"></i>
                        <span class="absolute -bottom-1 -right-1 text-[9px] font-bold text-gray-500">L</span>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-i18n="energy_1200">1200 –≠–Ω–µ—Ä–≥–∏–∏</div>
                        <div class="text-xs text-gray-500">899 ‚ÇΩ / 750 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-gray-400"><i class="fa-solid fa-plus"></i></div>
            </div>

            <!-- 3000 Energy -->
            <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform" onclick="openPaymentModal('energy_3000', '3000 –≠–Ω–µ—Ä–≥–∏–∏', 1500, 1790)">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-[#1f1f1f] border border-white/5 flex items-center justify-center text-yellow-400 text-lg relative">
                        <i class="fa-solid fa-bolt"></i>
                        <span class="absolute -bottom-1 -right-1 text-[9px] font-bold text-gray-500">MAX</span>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-i18n="energy_3000">3000 –≠–Ω–µ—Ä–≥–∏–∏</div>
                        <div class="text-xs text-gray-500">1790 ‚ÇΩ / 1 500 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-gray-400"><i class="fa-solid fa-plus"></i></div>
            </div>
        </div>

        <!-- 3. –ì–ï–ú–´ -->
        <div id="shop-section-gems" class="hidden space-y-3 animate-fade-up">
            <div class="text-xs font-bold text-gray-500 uppercase tracking-widest pl-1 mb-2" data-i18n="refill_gems">–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ì–µ–º–æ–≤</div>
            <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform" onclick="openPaymentModal('gems_50', '10 –ì–µ–º–æ–≤', 50, 69)">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-[#1f1f1f] border border-white/5 flex items-center justify-center text-cyan-400 text-lg relative">
                        <i class="fa-regular fa-gem"></i>
                        <span class="absolute -bottom-1 -right-1 text-[9px] font-bold text-gray-500">S</span>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-i18n="gems_50">10 –ì–µ–º–æ–≤</div>
                        <div class="text-xs text-gray-500">69 ‚ÇΩ / 50 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-gray-400"><i class="fa-solid fa-plus"></i></div>
            </div>
            <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform" onclick="openPaymentModal('gems_150', '30 –ì–µ–º–æ–≤', 125, 169)">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-[#1f1f1f] border border-white/5 flex items-center justify-center text-cyan-400 text-lg relative">
                        <i class="fa-regular fa-gem"></i>
                        <span class="absolute -bottom-1 -right-1 text-[9px] font-bold text-gray-500">M</span>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-i18n="gems_150">30 –ì–µ–º–æ–≤</div>
                        <div class="text-xs text-gray-500">169 ‚ÇΩ / 125 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-gray-400"><i class="fa-solid fa-plus"></i></div>
            </div>
            <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform border-cyan-500/30 bg-cyan-900/10" onclick="openPaymentModal('gems_500', '100 –ì–µ–º–æ–≤', 350, 449)">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-cyan-500/20 border border-cyan-500/30 flex items-center justify-center text-cyan-400 text-xl shadow-lg shadow-cyan-500/20">
                        <i class="fa-solid fa-gem"></i>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-i18n="gems_500">100 –ì–µ–º–æ–≤</div>
                        <div class="text-xs text-cyan-300 font-bold">449 ‚ÇΩ / 350 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-cyan-500 text-black flex items-center justify-center shadow-lg shadow-cyan-500/20"><i class="fa-solid fa-plus"></i></div>
            </div>
            <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform" onclick="openPaymentModal('gems_1200', '240 –ì–µ–º–æ–≤', 750, 899)">
                 <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-[#1f1f1f] border border-white/5 flex items-center justify-center text-cyan-400 text-lg relative">
                        <i class="fa-solid fa-sack-dollar"></i>
                        <span class="absolute -bottom-1 -right-1 text-[9px] font-bold text-gray-500">L</span>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-i18n="gems_1200">240 –ì–µ–º–æ–≤</div>
                        <div class="text-xs text-gray-500">899 ‚ÇΩ / 750 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-gray-400"><i class="fa-solid fa-plus"></i></div>
            </div>
            <div class="premium-card p-3 flex items-center justify-between active:scale-98 transition-transform" onclick="openPaymentModal('gems_3000', '600 –ì–µ–º–æ–≤', 1500, 1790)">
                 <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-[#1f1f1f] border border-white/5 flex items-center justify-center text-cyan-400 text-lg relative">
                        <i class="fa-solid fa-boxes-stacked"></i>
                        <span class="absolute -bottom-1 -right-1 text-[9px] font-bold text-gray-500">MAX</span>
                    </div>
                    <div>
                        <div class="font-bold text-white" data-i18n="gems_3000">600 –ì–µ–º–æ–≤</div>
                        <div class="text-xs text-gray-500">1790 ‚ÇΩ / 1 500 ‚≠êÔ∏è</div>
                    </div>
                </div>
                <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-gray-400"><i class="fa-solid fa-plus"></i></div>
            </div>
        </div>
    </div>

    <!-- ================= –ü–†–û–§–ò–õ–¨ ================= -->
    <div id="tab-profile" class="hidden px-4 animate-fade pb-20 min-h-screen">
        <div class="flex flex-col items-center pt-10 mb-6 relative">
             <div class="absolute top-12 left-1/2 -translate-x-1/2 w-40 h-40 bg-pink-600/20 rounded-full blur-[50px] pointer-events-none"></div>
            <div class="relative group active:scale-95 transition-transform cursor-pointer">
                <div class="w-32 h-32 rounded-full overflow-hidden border-[3px] border-[#222] shadow-2xl relative z-10">
                    <img src="https://placehold.co/200x200/222/fff?text=D" class="w-full h-full object-cover">
                </div>
                <div class="absolute bottom-1 right-1 z-20 bg-[#222] w-8 h-8 rounded-full flex items-center justify-center border border-white/10 text-white">
                    <i class="fa-solid fa-camera text-xs"></i>
                </div>
            </div>
            <h2 class="text-3xl font-black mt-4 text-white tracking-tight" data-i18n="settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            <button onclick="copyId()" id="copy-btn" class="flex items-center gap-2 mt-2 bg-white/5 hover:bg-white/10 px-3 py-1.5 rounded-full border border-white/5 transition-all active:scale-95">
                <span class="text-xs text-gray-400 font-mono tracking-wider">ID: 84932921</span>
                <i class="fa-regular fa-copy text-[10px] text-gray-500"></i>
            </button>
            <div id="copy-feedback" class="text-[10px] text-green-400 mt-1 opacity-0 transition-opacity font-bold" data-i18n="copied">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
        </div>

        <div class="relative w-full h-32 rounded-3xl overflow-hidden mb-6 flex border border-white/10 shadow-lg">
            <div class="absolute top-3 left-4 z-10 text-[10px] font-black text-white/50 tracking-[0.2em] uppercase backdrop-blur-sm px-2 py-1 rounded bg-black/20">Visual Style</div>
            <div class="w-1/2 h-full relative bg-gray-900 border-r border-white/5 active:opacity-90 transition-opacity cursor-pointer group" onclick="selectStyle('real')">
                <img src="https://placehold.co/300x200/111/444?text=Realistic" class="w-full h-full object-cover opacity-40 grayscale transition-all duration-500" id="img-real">
                <div class="absolute inset-0 flex flex-col items-center justify-end pb-4 bg-gradient-to-t from-black/80 to-transparent">
                    <div id="check-real" class="w-6 h-6 rounded-full border-2 border-gray-500 mb-2 transition-all duration-300"></div>
                    <span class="text-xs font-bold text-gray-300 group-hover:text-white transition-colors">REAL</span>
                </div>
            </div>
            <div class="w-1/2 h-full relative bg-gray-800 active:opacity-90 transition-opacity cursor-pointer group" onclick="selectStyle('anime')">
                <img src="https://placehold.co/300x200/220011/ff3b9a?text=Anime" class="w-full h-full object-cover opacity-80 transition-all duration-500" id="img-anime">
                <div class="absolute inset-0 flex flex-col items-center justify-end pb-4 bg-gradient-to-t from-black/80 to-transparent">
                    <div id="check-anime" class="w-6 h-6 rounded-full bg-gradient-to-r from-pink-500 to-purple-600 flex items-center justify-center mb-2 text-white text-xs shadow-lg shadow-pink-500/40 scale-110 transition-all duration-300">
                        <i class="fa-solid fa-check"></i>
                    </div>
                    <span class="text-xs font-bold text-white">ANIME</span>
                </div>
            </div>
        </div>

        <div class="space-y-3">
            <div class="premium-card p-4 flex justify-between items-center group cursor-pointer active:scale-98" onclick="toggleLanguage()">
                <div class="flex items-center gap-4">
                    <div class="w-10 h-10 rounded-full bg-[#1a1a1a] flex items-center justify-center text-gray-400 border border-white/5">
                        <i class="fa-solid fa-globe"></i>
                    </div>
                    <span data-i18n="language" class="font-medium text-sm text-gray-200">–Ø–∑—ã–∫</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex items-center gap-2 bg-white/5 px-2 py-1 rounded-lg border border-white/5">
                        <img id="flag-icon" src="https://flagcdn.com/w20/ru.png" class="w-4 rounded-sm shadow-sm">
                        <span id="lang-text" class="text-xs font-bold text-gray-300">RU</span>
                    </div>
                    <i class="fa-solid fa-chevron-right text-xs text-gray-600 group-hover:text-white transition-colors"></i>
                </div>
            </div>
        </div>

        <button onclick="usePromoCode()" class="w-full h-14 bg-gradient-to-r from-pink-600 to-purple-700 rounded-2xl font-bold mt-6 shadow-[0_10px_20px_rgba(219,39,119,0.2)] active:scale-98 transition-all flex items-center justify-center gap-2 border border-white/10 group overflow-hidden relative">
            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent skew-x-[-20deg] translate-x-[-150%] group-hover:animate-shine transition-all duration-1000"></div>
            <i class="fa-solid fa-ticket text-white/80"></i>¬†
            <span data-i18n="promo" class="tracking-wide">–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨ –ü–†–û–ú–û–ö–û–î</span>
        </button>

        
        <div class="text-center mt-8 text-[10px] text-gray-600 font-mono opacity-50">
            Build 2.4.0 (Prices Optimized)
        </div>
    </div>
    <div id="tab-admin" class="hidden px-4 animate-fade pb-24 min-h-screen">
        <h2 class="text-2xl font-black mt-6 text-white mb-4">üëë God Mode</h2>
    
        <div class="glass-panel p-4 rounded-2xl mb-6">
            <h3 class="text-sm font-bold text-gray-400 mb-2 uppercase">–ù–∞—á–∏—Å–ª–∏—Ç—å –∏–≥—Ä–æ–∫—É</h3>
            <input type="number" id="admin-target-id" placeholder="ID –∏–≥—Ä–æ–∫–∞ (chat_id)" class="admin-input">
            <div class="flex gap-2">
                <input type="number" id="admin-amount-stars" placeholder="Stars" class="admin-input">
                <input type="number" id="admin-amount-gems" placeholder="Gems" class="admin-input">
            </div>
            <button onclick="adminGiveResource()" class="admin-btn active:scale-95 transition-transform">–û–¢–ü–†–ê–í–ò–¢–¨</button>
        </div>
    
        <div class="glass-panel p-4 rounded-2xl">
            <h3 class="text-sm font-bold text-gray-400 mb-2 uppercase">–°–æ–∑–¥–∞—Ç—å –ü—Ä–æ–º–æ–∫–æ–¥</h3>
            <input type="text" id="admin-promo-code" placeholder="–ö–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä HELLO)" class="admin-input uppercase">
            <div class="flex gap-2">
                <input type="number" id="admin-promo-stars" placeholder="Stars" class="admin-input">
                <input type="number" id="admin-promo-gems" placeholder="Gems" class="admin-input">
            </div>
            <input type="number" id="admin-promo-uses" placeholder="–ö–æ–ª-–≤–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–π" value="100" class="admin-input">
            <button onclick="adminCreatePromo()" class="admin-btn bg-green-600 active:scale-95 transition-transform">–°–û–ó–î–ê–¢–¨ –ö–û–î</button>
        </div>
    </div>

    <!-- ================= –ù–ò–ñ–ù–ï–ï –ú–ï–ù–Æ ================= -->
    <div class="fixed bottom-6 left-4 right-4 z-50">
        <div class="glass-nav rounded-2xl h-[70px] flex justify-around items-center px-2 shadow-[0_10px_30px_rgba(0,0,0,0.5)] border border-white/10">
            <button onclick="showTab('home')" class="nav-btn w-full h-full flex flex-col items-center justify-center gap-1 text-white relative nav-active transition-all group" id="nav-home">
                <div class="nav-icon-container"><i class="fa-solid fa-gamepad text-xl group-hover:text-pink-400 transition-colors"></i></div>
                <span class="text-[9px] font-bold tracking-wider opacity-100 transition-opacity" data-i18n="nav_home">–ì–õ–ê–í–ù–ê–Ø</span>
                <div class="absolute bottom-1 w-1 h-1 bg-pink-500 rounded-full opacity-100 transition-opacity" id="dot-home"></div>
            </button>
            <button onclick="showTab('admin')" class="nav-btn hidden w-full h-full flex flex-col items-center justify-center gap-1 text-gray-500 relative transition-all group" id="nav-admin">
                <div class="nav-icon-container"><i class="fa-solid fa-lock text-xl group-hover:text-red-500 transition-colors"></i></div>
                <span class="text-[9px] font-bold tracking-wider opacity-70">ADMIN</span>
                <div class="absolute bottom-1 w-1 h-1 bg-red-500 rounded-full opacity-0 transition-opacity" id="dot-admin"></div>
            </button>
            <button onclick="showTab('shop')" class="nav-btn w-full h-full flex flex-col items-center justify-center gap-1 text-gray-500 relative transition-all group" id="nav-shop">
                <div class="nav-icon-container"><i class="fa-solid fa-store text-xl group-hover:text-white transition-colors"></i></div>
                <span class="text-[9px] font-bold tracking-wider opacity-70" data-i18n="nav_shop">–ú–ê–ì–ê–ó–ò–ù</span>
                <div class="absolute bottom-1 w-1 h-1 bg-pink-500 rounded-full opacity-0 transition-opacity" id="dot-shop"></div>
            </button>
            <button onclick="showTab('profile')" class="nav-btn w-full h-full flex flex-col items-center justify-center gap-1 text-gray-500 relative transition-all group" id="nav-profile">
                <div class="nav-icon-container"><i class="fa-solid fa-user text-xl group-hover:text-white transition-colors"></i></div>
                <span class="text-[9px] font-bold tracking-wider opacity-70" data-i18n="nav_profile">–ü–†–û–§–ò–õ–¨</span>
                <div class="absolute bottom-1 w-1 h-1 bg-pink-500 rounded-full opacity-0 transition-opacity" id="dot-profile"></div>
            </button>
        </div>
    </div>

    <!-- ================= –ú–û–î–ê–õ–ö–ê –û–ü–õ–ê–¢–´ ================= -->
    <div id="payment-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 modal-overlay" onclick="closePaymentModal()"></div>
        <div class="absolute bottom-0 left-0 w-full modal-content p-6 pb-12">
            <div class="w-16 h-1.5 bg-gray-700 rounded-full mx-auto mb-8 opacity-50"></div>
            <div class="flex items-start justify-between mb-6">
                <div>
                    <h3 class="text-2xl font-black text-white leading-tight" id="modal-title" data-i18n="purchase_title">–ü–æ–∫—É–ø–∫–∞</h3>
                    <p class="text-sm text-gray-400 mt-1 font-medium" data-i18n="secure_transaction">–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è</p>
                </div>
                <div class="w-14 h-14 bg-gradient-to-br from-gray-800 to-black rounded-2xl border border-white/10 flex items-center justify-center shadow-lg">
                    <span class="text-2xl animate-bounce">üõçÔ∏è</span>
                </div>
            </div>
            <div class="bg-white/5 rounded-2xl p-4 mb-6 border border-white/5 flex justify-between items-center">
                <span class="text-gray-400 text-sm" data-i18n="total_price">–ö –æ–ø–ª–∞—Ç–µ:</span>
                <div class="flex flex-col items-end">
                    <span class="text-xl font-bold text-white" id="modal-price-rub-display">0 ‚ÇΩ</span>
                    <span class="text-xs text-yellow-400 font-medium" id="modal-price-stars-display">–∏–ª–∏ 0 ‚≠êÔ∏è</span>
                </div>
            </div>
            <div class="space-y-3">
                <button onclick="confirmPayment('stars')" class="w-full bg-[#1e1e1e] border border-white/5 hover:border-yellow-500/50 rounded-2xl p-4 flex items-center justify-between group active:scale-98 transition-all">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-yellow-500/10 flex items-center justify-center border border-yellow-500/20"><i class="fa-solid fa-star text-yellow-400 text-lg"></i></div>
                        <div class="text-left">
                            <div class="text-base font-bold text-white">Telegram Stars</div>
                            <div class="text-[11px] text-gray-500" data-i18n="instant">–ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ</div>
                        </div>
                    </div>
                    <div class="bg-yellow-500/10 px-4 py-2 rounded-xl border border-yellow-500/20">
                        <span class="text-sm text-yellow-400 font-bold" id="modal-price-stars">0 ‚≠êÔ∏è</span>
                    </div>
                </button>
                <button onclick="confirmPayment('card')" class="w-full bg-[#1e1e1e] border border-white/5 hover:border-blue-500/50 rounded-2xl p-4 flex items-center justify-between group active:scale-98 transition-all">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-blue-500/10 flex items-center justify-center border border-blue-500/20"><i class="fa-regular fa-credit-card text-blue-400 text-lg"></i></div>
                        <div class="text-left">
                            <div class="text-base font-bold text-white" data-i18n="bank_card">–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞</div>
                            <div class="text-[11px] text-gray-500">RF Cards / SBP</div>
                        </div>
                    </div>
                    <div class="bg-blue-500/10 px-4 py-2 rounded-xl border border-blue-500/20">
                        <span class="text-sm text-blue-400 font-bold" id="modal-price-rub">0 ‚ÇΩ</span>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- ================= –ú–û–î–ê–õ–ö–ê –ü–ï–†–°–û–ù–ê–ñ–ê ================= -->
    <div id="character-modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 modal-overlay" onclick="closeCharacterModal()"></div>
        <div class="absolute bottom-0 left-0 w-full char-modal-content bg-[#111] overflow-hidden flex flex-col">
            <!-- –í–µ—Ä—Ö–Ω—è—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ -->
            <div class="relative w-full h-1/2">
                <img id="char-modal-img" src="" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-[#111] via-transparent to-transparent"></div>
                <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è -->
                <button onclick="closeCharacterModal()" class="absolute top-4 right-4 w-10 h-10 rounded-full bg-black/50 backdrop-blur-md flex items-center justify-center text-white border border-white/10 active:scale-90 transition-transform">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="flex-1 p-6 flex flex-col relative -mt-12 z-10">
                <div class="flex items-center gap-2 mb-3" id="char-modal-tags">
                    <!-- –¢–µ–≥–∏ —á–µ—Ä–µ–∑ JS -->
                </div>
                
                <h2 id="char-modal-name" class="text-3xl font-black text-white mb-2 leading-none">Name</h2>
                
                <div class="flex-1 overflow-y-auto pr-2 mb-6 text-sm text-gray-300 leading-relaxed custom-scroll" id="char-modal-desc">
                    Description goes here...
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ -->
                <button onclick="launchCharacter()" class="w-full h-14 bg-gradient-to-r from-pink-600 to-purple-700 rounded-2xl font-bold text-lg shadow-[0_10px_30px_rgba(219,39,119,0.4)] active:scale-98 transition-all flex items-center justify-center gap-3 border border-white/10 relative overflow-hidden group">
                    <span class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></span>
                    <i class="fa-solid fa-play"></i>
                    <span data-i18n="launch">–ó–ê–ü–£–°–¢–ò–¢–¨</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ================= JS ================= -->
    <script>
         // 1. –°—Å—ã–ª–∫–∞ –Ω–∞ –¢–í–û–ô –ù–û–í–´–ô –≤–µ–±—Ö—É–∫ (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ—é –∏–∑ n8n) 
        
        // 2. –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
        function fetchUserData() {
            const userId = tg.initDataUnsafe?.user?.id;
            
            // –ï—Å–ª–∏ –º—ã –ª–æ–∫–∞–ª—å–Ω–æ —Ç–µ—Å—Ç–∏–º –±–µ–∑ —Ç–µ–ª–µ–≥–∏, —Å—Ç–∞–≤–∏–º –∑–∞–≥–ª—É—à–∫—É, –∏–Ω–∞—á–µ –∫–æ–¥ —É–ø–∞–¥–µ—Ç
            if (!userId) {
                console.log("–ù–µ—Ç User ID (—Ç–µ—Å—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ?), —Å—Ç–∞–≤–∏–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ");
                return; 
            }
        
            fetch(WEBHOOK_GET_USER, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: userId })
            })
            .then(res => res.json())
            .then(data => {
                // n8n –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –º–∞—Å—Å–∏–≤ (–µ—Å–ª–∏ Get Rows), –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
                // –∏–ª–∏ –æ–±—ä–µ–∫—Ç. –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏–ª n8n.
                // –û–±—ã—á–Ω–æ Supabase Get –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤: [ {stars: 30, ...} ]
                const user = Array.isArray(data) ? data[0] : data;
        
                if (user) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º HTML
                    // –£–±–µ–¥–∏—Å—å, —á—Ç–æ ID —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å —Ç–≤–æ–∏–º HTML
                    if(document.getElementById('balance-stars')) 
                        document.getElementById('balance-stars').innerText = user.stars || 0;
                    
                    if(document.getElementById('balance-gems')) 
                        document.getElementById('balance-gems').innerText = user.gems || 0;
                        
                    console.log("–ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω:", user.stars, user.gems);
                }
            })
            .catch(err => console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:", err));
        }
        
        // 3. –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å—Ä–∞–∑—É, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å
        document.addEventListener('DOMContentLoaded', () => {
            // ... —Ç–≤–æ–π —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ ...
            fetchUserData(); // <--- –î–û–ë–ê–í–¨ –í–û–¢ –≠–¢–û
        });

        const tg = window.Telegram.WebApp;
        let currentItem = null; 
        let selectedCharacterId = null; 

        // ========================================================
        // üî¥ –í–ê–ñ–ù–û: –í—Å—Ç–∞–≤—å —Å—é–¥–∞ —Å—Å—ã–ª–∫—É –Ω–∞ Webhook –∏–∑ n8n!
        const WEBHOOK_URL = "https://b5b3fcb45140.ngrok-free.app/webhook/shop-buy";
        const WEBHOOK_LAUNCH = "https://f4c7-144-31-90-51.ngrok-free.app/webhook/start";
        const WEBHOOK_GET_USER = "https://f4c7-144-31-90-51.ngrok-free.app/webhook-test/get-user";
        const WEBHOOK_ADMIN = "https://f4c7-144-31-90-51.ngrok-free.app/webhook-test/admin-action";
        const WEBHOOK_USE_PROMO = "https://5b5d261635a0.ngrok-free.app/webhook-test/use-promo"; 
        // ========================================================
        
        // --- LOCALIZATION ---
        const translations = {
            ru: {
                hello: "–ü—Ä–∏–≤–µ—Ç", player: "–ò–≥—Ä–æ–∫", girls: "–î–ï–í–£–®–ö–ò", guys: "–ü–ê–†–ù–ò", packs: "–ü–ê–ö–ï–¢–´", energy: "–≠–ù–ï–†–ì–ò–Ø", gems: "–ì–ï–ú–´",
                nav_home: "–ì–õ–ê–í–ù–ê–Ø", nav_shop: "–ú–ê–ì–ê–ó–ò–ù", nav_profile: "–ü–†–û–§–ò–õ–¨", language: "–Ø–∑—ã–∫", promo: "–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨ –ü–†–û–ú–û–ö–û–î",
                online: "ONLINE", bonus: "–ë–û–ù–£–°", day_3: "–î–µ–Ω—å 3", 
                come_back: '–ó–∞—Ö–æ–¥–∏ –∑–∞–≤—Ç—Ä–∞ –∑–∞ <span class="text-yellow-400 font-bold">500 –º–æ–Ω–µ—Ç</span>',
                settings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏", copied: "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!", launch: "–ó–ê–ü–£–°–¢–ò–¢–¨",
                purchase_title: "–ü–æ–∫—É–ø–∫–∞", secure_transaction: "–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è", total_price: "–ö –æ–ø–ª–∞—Ç–µ:",
                instant: "–ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ", bank_card: "–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞", or: "–∏–ª–∏",
                pack_starter_desc: "–ù–∞–±–æ—Ä –Ω–æ–≤–∏—á–∫–∞", pack_premium_desc: "–í—ã–≥–æ–¥–Ω—ã–π –≤—ã–±–æ—Ä", pack_ultimate_desc: "–í—Å—ë –≤–∫–ª—é—á–µ–Ω–æ",
                energy_unit: "–≠–Ω–µ—Ä–≥–∏–∏", gems_unit: "–ì–µ–º–æ–≤",
                refill_energy: "–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≠–Ω–µ—Ä–≥–∏–∏", refill_gems: "–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ì–µ–º–æ–≤",
                energy_50: "50 –≠–Ω–µ—Ä–≥–∏–∏", energy_150: "150 –≠–Ω–µ—Ä–≥–∏–∏", energy_500: "500 –≠–Ω–µ—Ä–≥–∏–∏", energy_1200: "1200 –≠–Ω–µ—Ä–≥–∏–∏", energy_3000: "3000 –≠–Ω–µ—Ä–≥–∏–∏",
                gems_50: "10 –ì–µ–º–æ–≤", gems_150: "30 –ì–µ–º–æ–≤", gems_500: "100 –ì–µ–º–æ–≤", gems_1200: "240 –ì–µ–º–æ–≤", gems_3000: "600 –ì–µ–º–æ–≤"
            },
            en: {
                hello: "Hello", player: "Player", girls: "GIRLS", guys: "BOYS", packs: "PACKS", energy: "ENERGY", gems: "GEMS",
                nav_home: "HOME", nav_shop: "SHOP", nav_profile: "PROFILE", language: "Language", promo: "REDEEM CODE",
                online: "ONLINE", bonus: "BONUS", day_3: "Day 3", 
                come_back: 'Come back tomorrow for <span class="text-yellow-400 font-bold">500 coins</span>',
                settings: "Settings", copied: "Copied!", launch: "LAUNCH",
                purchase_title: "Purchase", secure_transaction: "Secure transaction", total_price: "Total:",
                instant: "Instant", bank_card: "Bank Card", or: "or",
                pack_starter_desc: "Starter Kit", pack_premium_desc: "Best Value", pack_ultimate_desc: "All Inclusive",
                energy_unit: "Energy", gems_unit: "Gems",
                refill_energy: "Energy Refill", refill_gems: "Gems Refill",
                energy_50: "50 Energy", energy_150: "150 Energy", energy_500: "500 Energy", energy_1200: "1200 Energy", energy_3000: "3000 Energy",
                gems_50: "10 Gems", gems_150: "30 Gems", gems_500: "100 Gems", gems_1200: "240 Gems", gems_3000: "600 Gems"
            }
        };

        let currentLang = 'ru'; 

        function setLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if(translations[lang][key]) {
                    if (key === 'come_back') {
                        el.innerHTML = translations[lang][key];
                    } else {
                        el.innerText = translations[lang][key];
                    }
                }
            });
            const flag = document.getElementById('flag-icon');
            const text = document.getElementById('lang-text');
            if(lang === 'ru') { flag.src = "https://flagcdn.com/w20/ru.png"; text.innerText = "RU"; } 
            else { flag.src = "https://flagcdn.com/w20/us.png"; text.innerText = "EN"; }
            
            renderCharacters();
        }

        function toggleLanguage() {
            setLanguage(currentLang === 'ru' ? 'en' : 'ru');
            tg.HapticFeedback.selectionChanged();
        }

        // --- DATA: MULTI-LANGUAGE CHARACTERS ---
        const characters = [
            { 
                id: 'char:stella', 
                name_ru: '–°—Ç–µ–ª–ª–∞', name_en: 'Stella',
                desc_ru: '–£–≤–∞–∂–∞–µ–º–∞—è –∂–µ–Ω—â–∏–Ω–∞-–≥–µ–Ω–µ—Ä–∞–ª, –æ—á–µ–Ω—å —Å–µ—Ä—å–µ–∑–Ω–∞—è –∏ —Ä–∞–∑–≤—Ä–∞—Ç–Ω–∞—è', desc_en: 'Respected female general, very serious and lewd',
                fullDesc_ru: '–ì–µ–Ω–µ—Ä–∞–ª –°—Ç–µ–ª–ª–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞ —Å–≤–æ–µ–π –∂–µ–ª–µ–∑–Ω–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–æ–π –∏ –±–µ—Å–∫–æ–º–ø—Ä–æ–º–∏—Å—Å–Ω–æ—Å—Ç—å—é –Ω–∞ —Å–ª—É–∂–±–µ. –ù–æ –∑–∞ –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –¥–≤–µ—Ä—è–º–∏ –µ—ë —É–Ω–∏—Ñ–æ—Ä–º–∞ —Å–∫—Ä—ã–≤–∞–µ—Ç –Ω–µ–Ω–∞—Å—ã—Ç–Ω—É—é —Å—Ç—Ä–∞—Å—Ç—å. –û–Ω–∞ –ø—Ä–∏–≤—ã–∫–ª–∞ –∫–æ–º–∞–Ω–¥–æ–≤–∞—Ç—å, –Ω–æ, –≤–æ–∑–º–æ–∂–Ω–æ, —Å —Ç–æ–±–æ–π –æ–Ω–∞ –∑–∞—Ö–æ—á–µ—Ç –Ω–∞—Ä—É—à–∏—Ç—å —Å—É–±–æ—Ä–¥–∏–Ω–∞—Ü–∏—é –∏ –ø–æ–∫–∞–∑–∞—Ç—å —Å–≤–æ—é –∏—Å—Ç–∏–Ω–Ω—É—é, —Ä–∞–∑–≤—Ä–∞—Ç–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å.',
                fullDesc_en: 'General Stella is known for her iron discipline and uncompromising attitude on duty. But behind closed doors, her uniform hides an insatiable passion. She is used to commanding, but perhaps with you, she will want to break subordination and show her true, lewd nature.',
                image: 'https://placehold.co/400x600/333/fff?text=Stella', 
                tags_ru: ['–í–ª–∞—Å—Ç–Ω–∞—è', '–í–æ–µ–Ω–Ω–∞—è'], tags_en: ['Dominant', 'Military'],
                online: true 
            },
            { 
                id: 'char:sauda', 
                name_ru: '–°–∞—É–¥–∞', name_en: 'Sauda',
                desc_ru: '–¢–µ–º–Ω–æ–∫–æ–∂–∞—è –¥–µ–≤—É—à–∫–∞ –∏–∑ –ø–ª–µ–º–µ–Ω–∏ —Å –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞–º–∏', desc_en: 'Dark-skinned tribal beauty with stunning curves',
                fullDesc_ru: '–°–∞—É–¥–∞ ‚Äî —ç–∫–∑–æ—Ç–∏—á–µ—Å–∫–∞—è –∫—Ä–∞—Å–∞–≤–∏—Ü–∞ –∏–∑ –¥–∞–ª–µ–∫–æ–≥–æ –ø–ª–µ–º–µ–Ω–∏, –Ω–µ —Ç—Ä–æ–Ω—É—Ç–æ–≥–æ —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–µ–π. –ï—ë –∫–æ–∂–∞ —Å–ª–æ–≤–Ω–æ —Ç–µ–º–Ω—ã–π —à–æ–∫–æ–ª–∞–¥, –∞ —Ñ–æ—Ä–º—ã —Å–≤–æ–¥—è—Ç —Å —É–º–∞. –û–Ω–∞ –∂–∏–≤–µ—Ç –∏–Ω—Å—Ç–∏–Ω–∫—Ç–∞–º–∏, –Ω–µ –∑–Ω–∞–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∞–±—É –∏ –≥–æ—Ç–æ–≤–∞ –ø–æ–¥–∞—Ä–∏—Ç—å —Ç–µ–±–µ –¥–∏–∫—É—é, –ø–µ—Ä–≤–æ–±—ã—Ç–Ω—É—é –ª—é–±–æ–≤—å, –æ –∫–æ—Ç–æ—Ä–æ–π —Ç—ã –º–æ–≥ —Ç–æ–ª—å–∫–æ –º–µ—á—Ç–∞—Ç—å.',
                fullDesc_en: 'Sauda is an exotic beauty from a distant tribe untouched by civilization. Her skin is like dark chocolate, and her curves are maddening. She lives by instincts, knows no modern taboos, and is ready to give you wild, primal love you could only dream of.',
                image: 'https://placehold.co/400x600/444/fff?text=Sauda', 
                tags_ru: ['–≠–∫–∑–æ—Ç–∏–∫–∞', '–î–∏–∫–∞—è'], tags_en: ['Exotic', 'Wild'],
                online: false 
            },
            { 
                id: 'char:lora', 
                name_ru: '–õ–æ—Ä–∞', name_en: 'Lora',
                desc_ru: '–ò–Ω—Å—Ç–∞–≥—Ä–∞–º–º –º–æ–¥–µ–ª—å', desc_en: 'Instagram model',
                fullDesc_ru: '–ó–≤–µ–∑–¥–∞ —Å–æ—Ü—Å–µ—Ç–µ–π, —á—å—è –∂–∏–∑–Ω—å –∫–∞–∂–µ—Ç—Å—è –∏–¥–µ–∞–ª—å–Ω–æ–π –≥–ª—è–Ω—Ü–µ–≤–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–æ–π. –ú–∏–ª–ª–∏–æ–Ω—ã –ª–∞–π–∫–æ–≤, —Ä–æ—Å–∫–æ—à–Ω—ã–µ –∫—É—Ä–æ—Ä—Ç—ã –∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ. –ù–æ –∑–∞ —ç–∫—Ä–∞–Ω–æ–º —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–µ–≤—É—à–∫–∞, –∂–∞–∂–¥—É—â–∞—è —Ä–µ–∞–ª—å–Ω—ã—Ö, –∞ –Ω–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —ç–º–æ—Ü–∏–π. –û–Ω–∞ –ø–æ–∫–∞–∂–µ—Ç —Ç–µ–±–µ –∏–∑–Ω–∞–Ω–∫—É —Ä–æ—Å–∫–æ—à–Ω–æ–π –∂–∏–∑–Ω–∏.',
                fullDesc_en: 'A social media star whose life seems like a perfect glossy picture. Millions of likes, luxury resorts, and endless attention. But behind the smartphone screen hides a girl craving real, not virtual emotions. She will show you the flip side of the luxury life.',
                image: 'https://placehold.co/400x600/111/fff?text=Lora', 
                tags_ru: ['–ú–æ–¥–µ–ª—å', '–ì–ª–∞–º—É—Ä'], tags_en: ['Model', 'Glamour'],
                online: true 
            },
            { 
                id: 'char:alex', 
                name_ru: '–ê–ª–µ–∫—Å', name_en: 'Alex',
                desc_ru: '–ë–µ–∑—É–º–Ω–æ –∫—Ä–∞—Å–∏–≤–∞—è –±–ª–æ–Ω–¥–∏–Ω–∫–∞ –∏–∑ —Å–µ–ª–∞', desc_en: 'Insanely beautiful blonde from the countryside',
                fullDesc_ru: '–ù–µ–≤–∏–Ω–Ω–∞—è –Ω–∞ –ø–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥ –±–ª–æ–Ω–¥–∏–Ω–∫–∞ –∏–∑ –≥–ª—É–±–∏–Ω–∫–∏, —á—å—è –ø—Ä–∏—Ä–æ–¥–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∞ –∑–∞—Ç–º–µ–≤–∞–µ—Ç –ª—é–±—ã—Ö –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π. –û–Ω–∞ –ø—Ä–æ—Å—Ç–∞, –¥–æ–≤–µ—Ä—á–∏–≤–∞ –∏ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –ø—Ä–∏—Ç—è–≥–∞—Ç–µ–ª—å–Ω–∞ –≤ —Å–≤–æ–µ–π –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏. –°–≤–µ–∂–∏–π –≤–æ–∑–¥—É—Ö –∏ –ø–∞—Ä–Ω–æ–µ –º–æ–ª–æ–∫–æ —Ç–≤–æ—Ä—è—Ç —á—É–¥–µ—Å–∞ —Å —Ñ–∏–≥—É—Ä–æ–π!',
                fullDesc_en: 'An innocent-looking blonde from the outback, whose natural beauty eclipses any city models. She is simple, trusting, and incredibly attractive in her naturalness. Fresh air and fresh milk work wonders for the figure!',
                image: 'https://placehold.co/400x600/555/fff?text=Alex', 
                tags_ru: ['–ù–µ–≤–∏–Ω–Ω–∞—è', '–î–µ—Ä–µ–≤–Ω—è'], tags_en: ['Innocent', 'Country'],
                online: true 
            },
             { 
                id: 'char:mira', 
                name_ru: '–ú–∏—Ä–∞', name_en: 'Mira',
                desc_ru: '–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞', desc_en: 'Athlete',
                fullDesc_ru: '–û–ª–∏–º–ø–∏–π—Å–∫–∞—è –Ω–∞–¥–µ–∂–¥–∞ —Å –∏–¥–µ–∞–ª—å–Ω—ã–º —Ç–µ–ª–æ–º. –î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî –µ—ë –∂–∏–∑–Ω—å, –Ω–æ –Ω–∞–∫–æ–ø–∏–≤—à—É—é—Å—è —ç–Ω–µ—Ä–≥–∏—é –Ω—É–∂–Ω–æ –∫—É–¥–∞-—Ç–æ –≤—ã–ø–ª–µ—Å–∫–∏–≤–∞—Ç—å. –û–Ω–∞ –≤—ã–Ω–æ—Å–ª–∏–≤–∞, –≥–∏–±–∫–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Å–∞–º—ã–º –¥–æ–ª–≥–∏–º –º–∞—Ä–∞—Ñ–æ–Ω–∞–º –Ω–∞–µ–¥–∏–Ω–µ —Å —Ç–æ–±–æ–π. –°–º–æ–∂–µ—à—å –ª–∏ —Ç—ã —É–≥–Ω–∞—Ç—å—Å—è –∑–∞ –µ—ë —Ç–µ–º–ø–æ–º?',
                fullDesc_en: 'Olympic hope with a perfect body. Discipline and training are her life, but the accumulated energy needs to be released somewhere. She is enduring, flexible, and ready for the longest marathons alone with you. Can you keep up with her pace?',
                image: 'https://placehold.co/400x600/222/fff?text=Mira', 
                tags_ru: ['–°–ø–æ—Ä—Ç', '–§–∏—Ç–Ω–µ—Å'], tags_en: ['Sport', 'Fitness'],
                online: false 
            },
             { 
                id: 'char:bella', 
                name_ru: '–ë–µ–ª–ª–∞', name_en: 'Bella',
                desc_ru: '–°–æ–±–ª–∞–∑–Ω–∏—Ç–µ–ª—å–Ω–∞—è —É—á–∏—Ç–µ–ª—å–Ω–∏—Ü–∞', desc_en: 'Seductive teacher',
                fullDesc_ru: '–°—Ç—Ä–æ–≥–∞—è —É—á–∏—Ç–µ–ª—å–Ω–∏—Ü–∞, –æ –∫–æ—Ç–æ—Ä–æ–π –º–µ—á—Ç–∞–µ—Ç –∫–∞–∂–¥—ã–π —Å—Ç—É–¥–µ–Ω—Ç. –ï—ë –æ—á–∫–∏ –∏ —É–∫–∞–∑–∫–∞ ‚Äî –ª–∏—à—å —Ä–µ–∫–≤–∏–∑–∏—Ç –¥–ª—è –∏–≥—Ä, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∞ –ø—Ä–∏–¥—É–º—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –∫–ª–∞—Å—Å –ø—É—Å—Ç–µ–µ—Ç. –û–Ω–∞ –≥–æ—Ç–æ–≤–∞ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–±—è –ø–æ—Å–ª–µ —É—Ä–æ–∫–æ–≤ –Ω–∞ "–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è", —á—Ç–æ–±—ã –ø–æ–¥—Ç—è–Ω—É—Ç—å –ø–æ —Å–∞–º—ã–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º –ø—Ä–µ–¥–º–µ—Ç–∞–º.',
                fullDesc_en: 'A strict teacher every student dreams of. Her glasses and pointer are just props for the games she invents when the class is empty. She is ready to keep you after school for "extra classes" to catch up on the most interesting subjects.',
                image: 'https://placehold.co/400x600/333/fff?text=Bella', 
                tags_ru: ['–£—á–∏—Ç–µ–ª—å', 'Roleplay'], tags_en: ['Teacher', 'Roleplay'],
                online: false 
            },
            { 
                id: 'char:aglaya', 
                name_ru: '–ê–≥–ª–∞—è', name_en: 'Aglaya',
                desc_ru: '–≠—Å–∫–æ—Ä—Ç–Ω–∏—Ü–∞ –ø–æ –≤—ã–∑–æ–≤—É', desc_en: 'High-class escort',
                fullDesc_ru: '–≠–ª–∏—Ç–Ω–∞—è —Å–ø—É—Ç–Ω–∏—Ü–∞ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –º–æ–∂–µ—Ç —Å–µ–±–µ —ç—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç—å. –û–Ω–∞ –∑–Ω–∞–µ—Ç –≤—Å–µ —Ç–∞–π–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è –º—É–∂—á–∏–Ω –∏ —É–º–µ–µ—Ç –∏—Ö –∏—Å–ø–æ–ª–Ω—è—Ç—å —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º –∏–∑—è—â–µ—Å—Ç–≤–æ–º. –° –Ω–µ–π –∫–∞–∂–¥—ã–π –≤–µ—á–µ—Ä –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –Ω–µ–∑–∞–±—ã–≤–∞–µ–º–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤ –∏ –ª–∏—à–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.',
                fullDesc_en: 'An elite companion for those who can afford it. She knows all the secret desires of men and knows how to fulfill them with professional grace. With her, every evening turns into an unforgettable adventure with no strings attached and no unnecessary questions.',
                image: 'https://placehold.co/400x600/666/fff?text=Aglaya', 
                tags_ru: ['VIP', '–≠—Å–∫–æ—Ä—Ç'], tags_en: ['VIP', 'Escort'],
                online: true 
            },
            { 
                id: 'char:yumi', 
                name_ru: '–Æ–º–∏', name_en: 'Yumi',
                desc_ru: '–û–¥–µ—Ä–∂–∏–º–∞ —Ç–æ–±–æ–π, —Å—Ç–∞–ª–∫–µ—Ä—à–∞', desc_en: 'Obsessed with you, stalker',
                fullDesc_ru: '–û–Ω–∞ –∑–Ω–∞–µ—Ç, –≥–¥–µ —Ç—ã –±—ã–ª, —Å –∫–µ–º –≥–æ–≤–æ—Ä–∏–ª –∏ —á—Ç–æ –µ–ª –Ω–∞ –∑–∞–≤—Ç—Ä–∞–∫. –ï—ë –ª—é–±–æ–≤—å –≥—Ä–∞–Ω–∏—á–∏—Ç —Å –±–µ–∑—É–º–∏–µ–º, –Ω–æ –Ω–∏–∫—Ç–æ –Ω–µ –±—É–¥–µ—Ç –ª—é–±–∏—Ç—å —Ç–µ–±—è —Ç–∞–∫ –ø—Ä–µ–¥–∞–Ω–Ω–æ –∏ —Å—Ç—Ä–∞—Å—Ç–Ω–æ, –∫–∞–∫ –æ–Ω–∞. –¢—ã —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –µ—ë, –∏ –æ–Ω–∞ –Ω–∏–∫–æ–º—É —Ç–µ–±—è –Ω–µ –æ—Ç–¥–∞—Å—Ç. –ë–µ—Ä–µ–≥–∏—Å—å –µ—ë —Ä–µ–≤–Ω–æ—Å—Ç–∏!',
                fullDesc_en: 'She knows where you were, who you talked to, and what you ate for breakfast. Her love borders on madness, but no one will love you as devotedly and passionately as she does. You are hers now, and she won\'t give you to anyone. Beware of her jealousy!',
                image: 'https://placehold.co/400x600/777/fff?text=Yumi', 
                tags_ru: ['–Ø–Ω–¥–µ—Ä–µ', '–°—Ç–∞–ª–∫–µ—Ä'], tags_en: ['Yandere', 'Stalker'],
                online: true 
            },
            { 
                id: 'char:tiffany', 
                name_ru: '–¢–∏—Ñ—Ñ–∞–Ω–∏', name_en: 'Tiffany',
                desc_ru: '–ì–ª—É–ø–∞—è –±–ª–æ–Ω–¥–∏–Ω–∫–∞ —Å –±–æ–ª—å—à–æ–π –≥—Ä—É–¥—å—é', desc_en: 'Bimbo blonde with big assets',
                fullDesc_ru: '–û—á–∞—Ä–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –≥–ª—É–ø—ã—à–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—É—Ç–∞–µ—Ç –ø—Ä–∞–≤–æ –∏ –ª–µ–≤–æ, –Ω–æ –æ—Ç–ª–∏—á–Ω–æ –∑–Ω–∞–µ—Ç, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–≤–æ–∏–º–∏ –≤—ã–¥–∞—é—â–∏–º–∏—Å—è –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–∞–º–∏. –° –Ω–µ–π –ª–µ–≥–∫–æ, –≤–µ—Å–µ–ª–æ –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—ã–≤–∞–µ—Ç —Å–∫—É—á–Ω–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –º–æ–º–µ–Ω—Ç–æ–º.',
                fullDesc_en: 'A charming ditz who confuses left and right but knows perfectly well how to use her outstanding assets. It\'s easy, fun, and never boring with her, especially if you don\'t ask complex questions and just enjoy the moment.',
                image: 'https://placehold.co/400x600/888/fff?text=Tiffany', 
                tags_ru: ['–ë–∏–º–±–æ', '–í–µ—Å–µ–ª—å–µ'], tags_en: ['Bimbo', 'Fun'],
                online: true 
            },
            { 
                id: 'char:mika', 
                name_ru: '–ú–∏–∫–∞', name_en: 'Mika',
                desc_ru: '–ü–æ–¥—Ä—É–≥–∞, —Å –∫–æ—Ç–æ—Ä–æ–π –≤—Å–µ –ø–µ—Ä–µ—Ä–æ—Å—Ç–∞–µ—Ç –≤–æ —á—Ç–æ —Ç–æ –±–æ–ª—å—à–µ–µ', desc_en: 'Friend turning into something more',
                fullDesc_ru: '–¢–≤–æ—è –ª—É—á—à–∞—è –ø–æ–¥—Ä—É–≥–∞ —Å –¥–µ—Ç—Å—Ç–≤–∞. –í—ã –¥–µ–ª–∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –∏ –∏–≥—Ä—É—à–∫–∏, –Ω–æ —Ç–µ–ø–µ—Ä—å –≤—ã—Ä–æ—Å–ª–∏, –∏ –Ω–µ–≤–∏–Ω–Ω—ã–µ –Ω–æ—á–µ–≤–∫–∏ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –Ω–µ—á—Ç–æ –±–æ–ª—å—à–µ–µ. –ì—Ä–∞–Ω–∏—Ü–∞ —Ñ—Ä–µ–Ω–¥–∑–æ–Ω—ã –≤–æ—Ç-–≤–æ—Ç –±—É–¥–µ—Ç —Å—Ç–µ—Ä—Ç–∞, –∏ —Å—Ç–∞—Ä–∞—è –¥—Ä—É–∂–±–∞ –≥–æ—Ç–æ–≤–∞ –ø–µ—Ä–µ—Ä–∞—Å—Ç–∏ –≤ —Å—Ç—Ä–∞—Å—Ç–Ω—É—é –ª—é–±–æ–≤—å.',
                fullDesc_en: 'Your best friend since childhood. You shared secrets and toys, but now you\'ve grown up, and innocent sleepovers are turning into something more. The friend zone boundary is about to be erased, and old friendship is ready to grow into passionate love.',
                image: 'https://placehold.co/400x600/999/fff?text=Mika', 
                tags_ru: ['–ü–æ–¥—Ä—É–≥–∞', '–†–æ–º–∞–Ω—Ç–∏–∫–∞'], tags_en: ['Friend', 'Romance'],
                online: false 
            }
        ];

        // 3. –ï–î–ò–ù–ê–Ø –¢–û–ß–ö–ê –í–•–û–î–ê (–ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ)
        document.addEventListener('DOMContentLoaded', () => {
            tg.ready(); 
            tg.expand(); 
            tg.setHeaderColor('#050505'); 
            tg.setBackgroundColor('#050505');
            
            renderCharacters(); 
            setLanguage('ru');
            
            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –±–∞–ª–∞–Ω—Å
            fetchUserData(); 
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–¥–º–∏–Ω –ª–∏ —ç—Ç–æ (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É)
            checkAdmin(); 
        });

        function renderCharacters() {
            const container = document.getElementById('characters-container');
            container.innerHTML = characters.map((char, index) => {
                // Select language specific fields
                const tags = char['tags_' + currentLang];
                const name = char['name_' + currentLang];
                const desc = char['desc_' + currentLang];

                const tagsHtml = tags.map(tag => `<span class="bg-black/60 backdrop-blur-sm border border-white/10 px-1.5 py-0.5 rounded text-[9px] font-bold text-gray-300">${tag}</span>`).join('');
                const statusHtml = char.online ? `<div class="absolute top-2 right-2 w-3 h-3 bg-green-500 rounded-full border-2 border-[#1a1a1a] shadow-[0_0_8px_#22c55e]"></div>` : '';
                const delayClass = index % 2 === 0 ? 'delay-100' : 'delay-200';

                return `
                <div onclick="openCharacterModal('${char.id}')" class="relative rounded-3xl overflow-hidden h-[280px] bg-[#1a1a1a] active:scale-95 transition-transform duration-300 border border-white/5 shadow-lg group cursor-pointer animate-fade-up ${delayClass}">
                    <img src="${char.image}" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700" alt="${name}">
                    ${statusHtml}
                    <div class="absolute inset-0 bg-gradient-to-t from-black via-black/30 to-transparent"></div>
                    <div class="absolute bottom-0 left-0 w-full p-4 transform translate-y-1 group-hover:translate-y-0 transition-transform">
                        <div class="flex gap-1 mb-2">${tagsHtml}</div>
                        <h3 class="text-xl font-black text-white leading-tight drop-shadow-md mb-1">${name}</h3>
                        <p class="text-xs text-gray-300 line-clamp-2 leading-relaxed opacity-90">${desc}</p>
                        <div class="w-full h-[2px] bg-gradient-to-r from-pink-500 to-transparent mt-3 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                    </div>
                </div>
            `}).join('');
        }

        // --- Character Modal Logic ---
        function openCharacterModal(charId) {
            tg.HapticFeedback.impactOccurred('medium');
            const char = characters.find(c => c.id === charId);
            if (!char) return;

            selectedCharacterId = charId;

            // Get localized data
            const name = char['name_' + currentLang];
            const fullDesc = char['fullDesc_' + currentLang] || char['desc_' + currentLang];
            const tags = char['tags_' + currentLang];

            // Populate Modal
            document.getElementById('char-modal-img').src = char.image;
            document.getElementById('char-modal-name').innerText = name;
            document.getElementById('char-modal-desc').innerText = fullDesc;
            
            // Tags
            const tagsContainer = document.getElementById('char-modal-tags');
            tagsContainer.innerHTML = tags.map(tag => 
                `<span class="bg-pink-600/20 text-pink-300 px-2 py-1 rounded-lg text-xs font-bold border border-pink-500/20">${tag}</span>`
            ).join('');

            // Show Modal
            const modal = document.getElementById('character-modal');
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.add('modal-open');
            }, 10);
        }

        function closeCharacterModal() {
            const modal = document.getElementById('character-modal');
            modal.classList.remove('modal-open');
            setTimeout(() => {
                modal.classList.add('hidden');
                selectedCharacterId = null;
            }, 300);
        }

        // --- –õ–û–ì–ò–ö–ê –ó–ê–ü–£–°–ö–ê –ü–ï–†–°–û–ù–ê–ñ–ê (–ó–ê–ö–†–´–í–ê–ï–¢ –û–ö–ù–û) ---
        function launchCharacter() {
            if (!selectedCharacterId) return;
            tg.HapticFeedback.notificationOccurred('success');
        
            // –®–ª–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ù–û–í–´–ô –≤–µ–±—Ö—É–∫
            fetch(WEBHOOK_LAUNCH, { 
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    character_id: selectedCharacterId,
                    chat_id: tg.initDataUnsafe?.user?.id,
                    first_name: tg.initDataUnsafe?.user?.first_name
                })
            })
            .then(() => {
                tg.close(); // –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ, –≤—Å—ë –æ–∫
            })
            .catch(err => {
                console.error(err);
                tg.showAlert("–û—à–∏–±–∫–∞. –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Å–æ–ª—å.");
            });
        }

        // --- EXISTING LOGIC ---
        function showTab(tabId) {
            tg.HapticFeedback.impactOccurred('light');
            document.getElementById('tab-home').classList.add('hidden');
            document.getElementById('tab-shop').classList.add('hidden');
            document.getElementById('tab-profile').classList.add('hidden');
            
            ['home', 'shop', 'profile'].forEach(id => {
                document.getElementById(`nav-${id}`).classList.remove('nav-active', 'text-white');
                document.getElementById(`nav-${id}`).classList.add('text-gray-500');
                document.getElementById(`dot-${id}`).classList.replace('opacity-100', 'opacity-0');
            });

            const activeTab = document.getElementById(`tab-${tabId}`);
            activeTab.classList.remove('hidden');
            activeTab.classList.remove('animate-fade-up');
            void activeTab.offsetWidth; activeTab.classList.add('animate-fade-up');

            document.getElementById(`nav-${tabId}`).classList.add('nav-active', 'text-white');
            document.getElementById(`nav-${tabId}`).classList.remove('text-gray-500');
            document.getElementById(`dot-${tabId}`).classList.replace('opacity-0', 'opacity-100');

            // Header logic
            const genderSwitch = document.getElementById('gender-switch');
            const shopSwitch = document.getElementById('shop-switch');
            if(tabId === 'shop') { genderSwitch.classList.add('hidden'); shopSwitch.classList.remove('hidden'); } 
            else if (tabId === 'home') { shopSwitch.classList.add('hidden'); genderSwitch.classList.remove('hidden'); } 
            else { shopSwitch.classList.add('hidden'); genderSwitch.classList.add('hidden'); }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function switchShopSubTab(subTabName) {
            tg.HapticFeedback.impactOccurred('light');
            ['packs', 'energy', 'gems'].forEach(n => document.getElementById(`shop-section-${n}`).classList.add('hidden'));
            const section = document.getElementById(`shop-section-${subTabName}`);
            section.classList.remove('hidden'); section.classList.remove('animate-fade-up'); void section.offsetWidth; section.classList.add('animate-fade-up');

            ['packs', 'energy', 'gems'].forEach(name => {
                const btn = document.getElementById(`btn-sub-${name}`);
                if (name === subTabName) { btn.classList.add('tab-active', 'font-bold'); btn.classList.remove('tab-inactive', 'font-medium'); } 
                else { btn.classList.remove('tab-active', 'font-bold'); btn.classList.add('tab-inactive', 'font-medium'); }
            });
        }
        function switchTab(tabId) { showTab(tabId); }

        function selectStyle(style) {
            tg.HapticFeedback.impactOccurred('medium');
            const checkReal = document.getElementById('check-real'); const checkAnime = document.getElementById('check-anime');
            const imgReal = document.getElementById('img-real'); const imgAnime = document.getElementById('img-anime');
            if (style === 'real') {
                checkReal.className = "w-6 h-6 rounded-full bg-gradient-to-r from-pink-500 to-purple-600 flex items-center justify-center mb-2 text-white text-xs shadow-lg shadow-pink-500/40 scale-110 transition-all duration-300";
                checkReal.innerHTML = '<i class="fa-solid fa-check"></i>'; imgReal.classList.remove('grayscale', 'opacity-40');
                checkAnime.className = "w-6 h-6 rounded-full border-2 border-gray-500 mb-2 transition-all duration-300";
                checkAnime.innerHTML = ''; imgAnime.classList.add('grayscale', 'opacity-40');
            } else {
                checkAnime.className = "w-6 h-6 rounded-full bg-gradient-to-r from-pink-500 to-purple-600 flex items-center justify-center mb-2 text-white text-xs shadow-lg shadow-pink-500/40 scale-110 transition-all duration-300";
                checkAnime.innerHTML = '<i class="fa-solid fa-check"></i>'; imgAnime.classList.remove('grayscale', 'opacity-40');
                checkReal.className = "w-6 h-6 rounded-full border-2 border-gray-500 mb-2 transition-all duration-300";
                checkReal.innerHTML = ''; imgReal.classList.add('grayscale', 'opacity-40');
            }
        }

        function openPaymentModal(packId, title, priceStars, priceRub) {
            tg.HapticFeedback.impactOccurred('medium');
            currentItem = { id: packId, amountStars: priceStars, amountRub: priceRub };
            document.getElementById('modal-title').innerText = translations[currentLang].purchase_title;
            document.getElementById('modal-price-stars').innerText = priceStars + " ‚≠êÔ∏è";
            document.getElementById('modal-price-rub').innerText = priceRub + " ‚ÇΩ";
            document.getElementById('modal-price-rub-display').innerText = priceRub + " ‚ÇΩ";
            document.getElementById('modal-price-stars-display').innerText = translations[currentLang].or + " " + priceStars + " ‚≠êÔ∏è";
            const modal = document.getElementById('payment-modal');
            modal.classList.remove('hidden'); setTimeout(() => modal.classList.add('modal-open'), 10);
        }

        function closePaymentModal() {
            const modal = document.getElementById('payment-modal');
            modal.classList.remove('modal-open'); setTimeout(() => modal.classList.add('hidden'), 300);
        }

        // --- –õ–û–ì–ò–ö–ê –û–ü–õ–ê–¢–´ (–ù–ï –ó–ê–ö–†–´–í–ê–ï–¢ –û–ö–ù–û) ---
        // --- –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê: –ú–ì–ù–û–í–ï–ù–ù–ê–Ø –û–ü–õ–ê–¢–ê ---
        function confirmPayment(method) {
            tg.HapticFeedback.selectionChanged();
            
            if (WEBHOOK_URL.includes("–í–°–¢–ê–í–¨_–°–Æ–î–ê")) {
                tg.showAlert("–û—à–∏–±–∫–∞: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω Webhook!");
                return;
            }
        
            const modalTitle = document.getElementById('modal-title');
            const originalText = modalTitle.innerText;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            modalTitle.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> –°–æ–∑–¥–∞–µ–º —Å—á–µ—Ç...';
        
            const userId = tg.initDataUnsafe?.user?.id;
            
            // 1. –ü—Ä–æ—Å–∏–º n8n —Å–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É
            fetch(WEBHOOK_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action: "buy_invoice", 
                    pack_id: currentItem.id,
                    amount: method === 'stars' ? currentItem.amountStars : currentItem.amountRub,
                    currency: method === 'stars' ? 'XTR' : 'RUB', 
                    method: method,
                    chat_id: userId
                })
            })
            .then(response => response.json()) // –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º –æ—Ç–≤–µ—Ç –≤ –æ–±—ä–µ–∫—Ç
            .then(data => {
                // n8n –≤–µ—Ä–Ω–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç Telegram. –°—Å—ã–ª–∫–∞ –ª–µ–∂–∏—Ç –≤ –ø–æ–ª–µ 'result'
                if (data.ok && data.result) {
                    // 2. –û–¢–ö–†–´–í–ê–ï–ú –ù–ê–¢–ò–í–ù–û–ï –û–ö–ù–û –û–ü–õ–ê–¢–´
                    tg.openInvoice(data.result, (status) => {
                        // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–≥–¥–∞ —é–∑–µ—Ä –∑–∞–∫—Ä–æ–µ—Ç –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã
                        if (status === 'paid') {
                            tg.showAlert("–£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞! üéâ\n–í–∞–ª—é—Ç–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∞.");
                            closePaymentModal();
                            // –¢—É—Ç –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –Ω–∞ —ç–∫—Ä–∞–Ω–µ, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å
                        } else if (status === 'cancelled') {
                            tg.showAlert("–û–ø–ª–∞—Ç–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞.");
                        } else if (status === 'pending') {
                            tg.showAlert("–û–ø–ª–∞—Ç–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è...");
                        } else {
                            tg.showAlert("–°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã: " + status);
                        }
                    });
                } else {
                    console.error(data);
                    tg.showAlert("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å—á–µ—Ç–∞ (—Å–º. –∫–æ–Ω—Å–æ–ª—å)");
                }
            })
            .catch(error => {
                console.error('Error:', error);
                tg.showAlert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏.");
            })
            .finally(() => {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞
                modalTitle.innerText = originalText;
            });
        }

        function copyId() {
            tg.HapticFeedback.impactOccurred('light');
            const feedback = document.getElementById('copy-feedback');
            feedback.style.opacity = '1';
            setTimeout(() => feedback.style.opacity = '0', 2000);
        }
        // 1. –¢–≤–æ–π ID (–≤–æ–∑—å–º–∏ –µ–≥–æ –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –≤ –±–æ—Ç–µ –∏–ª–∏ get-user –≤–µ–±—Ö—É–∫–∞)
        const ADMIN_IDS = [7672744848, 6546116205]; // –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π —Ä–µ–∞–ª—å–Ω—ã–π ID! 


            // 1. –°—Å—ã–ª–∫–∞ –Ω–∞ –Ω–æ–≤—ã–π –≤–µ–±—Ö—É–∫ (—Å–æ–∑–¥–∞–¥–∏–º –µ–≥–æ –Ω–∞ –≠—Ç–∞–ø–µ 3)
        // –ü–æ–∫–∞ –ø–æ—Å—Ç–∞–≤—å –∑–∞–≥–ª—É—à–∫—É –∏–ª–∏ ngrok –∞–¥—Ä–µ—Å, –ø–æ—Ç–æ–º –∑–∞–º–µ–Ω–∏—à—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –∏–∑ n8n
        
        function usePromoCode() {
            // –ü—Ä–æ—Å—Ç–æ–µ –æ–∫–Ω–æ –≤–≤–æ–¥–∞
            let code = prompt("–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥:");
            
            // –ï—Å–ª–∏ –Ω–∞–∂–∞–ª –æ—Ç–º–µ–Ω—É –∏–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –≤–≤–µ–ª
            if (!code) return;
        
            // –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã –∏ –¥–µ–ª–∞–µ–º –∫–∞–ø—Å–æ–º (—á—Ç–æ–±—ã hello –∏ HELLO –±—ã–ª–æ –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ)
            code = code.trim().toUpperCase();
        
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—Ä—É—Ç–∏–ª–∫—É –∑–∞–≥—Ä—É–∑–∫–∏
            tg.MainButton.showProgress();
        
            fetch(WEBHOOK_USE_PROMO, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: tg.initDataUnsafe?.user?.id,
                    code: code
                })
            })
            .then(res => res.json())
            .then(data => {
                tg.MainButton.hideProgress(); // –£–±–∏—Ä–∞–µ–º –∫—Ä—É—Ç–∏–ª–∫—É
                
                if (data.success) {
                    // –ï—Å–ª–∏ —É—Å–ø–µ—Ö
                    tg.showAlert(`‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ!\n–ü–æ–ª—É—á–µ–Ω–æ:\n‚ö° ${data.stars}\nüíé ${data.gems}`);
                    fetchUserData(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–∏—Ñ—Ä—ã –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Å—Ä–∞–∑—É
                } else {
                    // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ (–∫–æ–¥ –Ω–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω)
                    tg.showAlert("‚ùå –û—à–∏–±–∫–∞: " + (data.message || "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥"));
                }
            })
            .catch(err => {
                tg.MainButton.hideProgress();
                tg.showAlert("–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è");
                console.error(err);
            });
        }
        
        // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function checkAdmin() {
            const userId = tg.initDataUnsafe?.user?.id;
            if (ADMIN_IDS.includes(userId)) {
                document.getElementById('nav-admin').classList.remove('hidden'); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
            }
        }
        
        // –î–æ–±–∞–≤—å –≤—ã–∑–æ–≤ checkAdmin() –≤ document.addEventListener('DOMContentLoaded', ...)
        // document.addEventListener('DOMContentLoaded', () => {
        //    ... fetchUserData();
        //    checkAdmin(); <--- –í–û–¢ –°–Æ–î–ê
        // });
        
        // 3. –§—É–Ω–∫—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π
        function adminGiveResource() {
            const targetId = document.getElementById('admin-target-id').value;
            const stars = document.getElementById('admin-amount-stars').value || 0;
            const gems = document.getElementById('admin-amount-gems').value || 0;
        
            if(!targetId) return tg.showAlert("–í–≤–µ–¥–∏ ID –∏–≥—Ä–æ–∫–∞!");
        
            fetch(WEBHOOK_ADMIN, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    action: 'give_resource',
                    admin_id: tg.initDataUnsafe?.user?.id, // –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
                    target_id: targetId,
                    stars: parseInt(stars),
                    gems: parseInt(gems)
                })
            }).then(() => tg.showAlert("–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!"))
              .catch(() => tg.showAlert("–û—à–∏–±–∫–∞"));
        }
        
        function adminCreatePromo() {
            const code = document.getElementById('admin-promo-code').value;
            const stars = document.getElementById('admin-promo-stars').value || 0;
            const gems = document.getElementById('admin-promo-gems').value || 0;
            const uses = document.getElementById('admin-promo-uses').value || 1;
        
            if(!code) return tg.showAlert("–í–≤–µ–¥–∏ –∫–æ–¥!");
        
            fetch(WEBHOOK_ADMIN, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    action: 'create_promo',
                    admin_id: tg.initDataUnsafe?.user?.id,
                    code: code,
                    stars: parseInt(stars),
                    gems: parseInt(gems),
                    uses: parseInt(uses)
                })
            }).then(() => tg.showAlert("–ü—Ä–æ–º–æ–∫–æ–¥ —Å–æ–∑–¥–∞–Ω!"))
              .catch(() => tg.showAlert("–û—à–∏–±–∫–∞"));
        }
    </script>
</body>
</html>
